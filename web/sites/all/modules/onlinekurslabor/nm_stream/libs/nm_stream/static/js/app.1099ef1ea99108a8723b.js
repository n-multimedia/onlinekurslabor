webpackJsonp([1],{"0dp7":function(t,e){},"0eAL":function(t,e){},"1/oy":function(t,e){},"9BHd":function(t,e){},Avkv:function(t,e){},GfHa:function(t,e){},Id91:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),a={props:["streamOptions","post","editComment"],name:"stream-comment-form",methods:{resizeTextarea:function(t){this.resizeTextareaElement(t.target),this.resizeCommentFormContainer()},resizeCommentFormContainer:function(){this.editComment&&(this.$parent.$el.querySelector(".stream-comment").style.height=150+this.$el.querySelector("textarea").scrollHeight+"px",console.log(this.$parent.$el.querySelector(".stream-comment").style.height))},saveComment:function(){this.busyLoading=!0;var t=this,e={};if(e.body=this.bodyText,this.editComment){var s=this.$config.get("api.apiCommentUpdateUrl").replace("%comment",this.editComment.cid).replace("%token",this.streamOptions.token);i.a.axios.post(s,e,{withCredentials:!0}).then(function(e){t.resetForm(),1===e.data.status&&(t.editComment.body_formatted=e.data.commentData.body_formatted,t.editComment.body=e.data.commentData.body,t.resetForm())})}else{var a=this.$config.get("api.apiCommentAddUrl").replace("%node",this.post.nid).replace("%token",this.streamOptions.token);i.a.axios.post(a,e,{withCredentials:!0}).then(function(e){if(t.resetForm(),1===e.data.status){var s=e.data.commentData,i=e.data.userData;t.$emit("stream-comment-added",s),t.$emit("stream-user-added",i)}})}},resizeTextareaElement:function(t){t.style.height="auto",t.style.height=t.scrollHeight+"px"},resetForm:function(){this.editComment?(this.$emit("form-edit-canceled"),this.$parent.$el.querySelector(".stream-comment").style.height="auto"):(this.bodyText="",this.formActive=!1,this.$el.querySelector("textarea.stream-comment-body").blur(),this.$el.querySelector("textarea.stream-comment-body").style.height="auto"),this.busyLoading=!1},initializeComment:function(){var t=this;this.editComment&&(this.formActive=!0,this.bodyText=this.editComment.body,this.$nextTick(function(){t.resizeTextareaElement(t.$el.querySelector("textarea")),t.resizeCommentFormContainer()}))},updateAuthor:function(){this.author=this.streamOptions.loggedInUser,this.editComment&&(this.author=this.editComment.user)}},mounted:function(){var t=this;this.$nextTick(function(){t.$el.setAttribute("style","height:"+t.$el.scrollHeight+"px;overflow-y:hidden;"),t.$el.addEventListener("input",t.resizeTextarea)}),this.updateAuthor()},beforeDestroy:function(){this.$el.removeEventListener("input",this.resizeTextarea)},render:function(){return this.$slots.default[0]},data:function(){return{formActive:!1,busyLoading:!1,busyLoadingColor:"#888",busyLoadingSize:"10px",author:null,bodyText:""}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"stream-comment-from card"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-2"},[s("transition",{attrs:{name:"fade"}},[t.formActive?s("img",{key:t.formActive,staticClass:"card-img-top rounded-circle",attrs:{src:t.author.avatarUrl,title:t.author.name}}):t._e()])],1),t._v(" "),s("div",{staticClass:"col-10"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.bodyText,expression:"bodyText"}],staticClass:"stream-comment-body",attrs:{name:"body",disabled:t.busyLoading,placeholder:t.$t("placeholder.your_comment_message")},domProps:{value:t.bodyText},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"esc",27,e.key,"Escape")?t.resetForm(e):null},focus:function(e){t.formActive=!0},input:function(e){e.target.composing||(t.bodyText=e.target.value)}}}),t._v(" "),s("transition",{attrs:{name:"fade"}},[s("div",{key:t.formActive,staticClass:"row stream-action-2"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"row"},[t.formActive?s("div",{staticClass:"col-12 action-buttons"},[s("button",{staticClass:"btn btn-outline-primary stream-comment-post float-right",attrs:{disabled:this.bodyText.length<1||t.busyLoading},on:{click:t.saveComment}},[t._v(t._s(t.$t("button.post")))]),t._v(" "),s("button",{staticClass:"btn btn-outline-secondary stream-comment-cancel float-right",attrs:{disabled:t.busyLoading},on:{click:t.resetForm}},[t._v(t._s(t.$t("button.cancel")))]),t._v(" "),s("pulse-loader",{attrs:{loading:t.busyLoading,color:t.busyLoadingColor,size:t.busyLoadingSize}})],1):t._e()])])])])],1)])])},staticRenderFns:[]};var o=s("VU/8")(a,n,!1,function(t){s("zLEU")},"data-v-3b68c28a",null).exports,r={props:["streamOptions","comment","user"],components:{StreamCommentForm:o},name:"stream-comment",data:function(){return{}},computed:{canEdit:function(){return this.comment.permissions.canEdit},canDelete:function(){return this.comment.permissions.canDelete}},methods:{editComment:function(t){var e=this;this.$el.classList.add("flip-active"),setTimeout(function(){e.$refs.streamCommentForm.initializeComment(),e.$refs.backDelete.classList.add("hide"),e.$refs.backEdit.classList.remove("hide"),e.$refs.streamCommentForm.initializeComment()},200)},deleteComment:function(t){var e=this;setTimeout(function(){e.$el.classList.add("flip-active"),e.$refs.backEdit.classList.add("hide"),e.$refs.backDelete.classList.remove("hide")},200)},onDelete:function(t){var e=this,s=this,a=this.$config.get("api.apiCommentDeleteUrl").replace("%comment",this.comment.cid).replace("%token",this.streamOptions.token);i.a.axios.get(a,{withCredentials:!0}).then(function(t){1===t.data.status&&(s.$emit("stream-comment-deleted",s.comment),e.$el.classList.remove("flip-active"))})},onDeleteCancel:function(t){this.$el.classList.remove("flip-active")},editCanceled:function(t){this.$el.classList.remove("flip-active")}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card-flip"},[s("div",{staticClass:"flip"},[s("div",{staticClass:"front"},[s("div",{staticClass:"stream-comment card"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-2"},[s("img",{staticClass:"card-img-top rounded-circle",attrs:{src:t.user.avatarUrl,title:t.user.name}})]),t._v(" "),s("div",{staticClass:"col-10"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[t.canEdit||t.canDelete?s("div",[s("b-dropdown",{staticClass:"post-actions-dropdown m-md-2 float-right",attrs:{text:"...",offset:"-120"}},[t.canEdit?s("b-dropdown-item",{on:{click:t.editComment}},[t._v(t._s(t.$t("button.edit")))]):t._e(),t._v(" "),t.canDelete?s("b-dropdown-item",{on:{click:t.deleteComment}},[t._v(t._s(t.$t("button.delete")))]):t._e()],1)],1):t._e(),t._v(" "),s("div",{staticClass:"username"},[s("a",{attrs:{href:t.user.profileUrl}},[t._v(t._s(t.user.name))])]),t._v(" "),s("div",{staticClass:"created"},[s("span",{attrs:{title:t._f("moment")(t.comment.created,"L LT")}},[t._v(" "+t._s(t._f("moment")(t.comment.created,"from")))])])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-12 body"},[s("p",{attrs:{tag:"p"},domProps:{innerHTML:t._s(t.comment.body_formatted)}})])])])])])]),t._v(" "),s("div",{ref:"backEdit",staticClass:"back-edit"},[s("div",{staticClass:"stream-comment card"},[s("stream-comment-form",{ref:"streamCommentForm",attrs:{streamOptions:t.streamOptions,editComment:t.comment},on:{"form-edit-canceled":function(e){t.editCanceled()}}})],1)]),t._v(" "),s("div",{ref:"backDelete",staticClass:"back-delete"},[s("div",{staticClass:"stream-post card"},[s("h4",[t._v(t._s(t.$t("warning.delete_comment_really_want_to")))]),t._v(" "),s("br"),t._v(" "),s("p",[t._v("\n          "+t._s(t.$t("warning.delete_comment_action_cannot_be_undone"))+"\n        ")]),t._v(" "),s("div",{staticClass:"float-right"},[s("button",{staticClass:"btn btn-outline-danger float-right",on:{click:function(e){t.onDelete()}}},[t._v(t._s(t.$t("button.delete")))]),t._v(" "),s("button",{staticClass:"btn btn-outline-secondary float-right",on:{click:function(e){t.onDeleteCancel()}}},[t._v(t._s(t.$t("button.cancel")))])])])])])])},staticRenderFns:[]};var c=s("VU/8")(r,l,!1,function(t){s("Pjiz")},"data-v-22aae948",null).exports,d=s("KvPw"),m=s.n(d),p=(s("9BHd"),{props:["streamOptions","editPost"],name:"stream-post-form",components:{vueDropzone:m.a},methods:{resizeTextarea:function(t){this.resizeTextareaElement(t.target),this.resizePostFormContainer()},resizePostFormContainer:function(){if(this.editPost){var t=parseFloat(this.$refs.vueDropZome.$el.style.height),e=0;this.$refs.postAttachmentList&&(e=parseFloat(this.$refs.postAttachmentList.clientHeight)),this.$parent.$el.querySelector(".stream-post").style.height=150+t+e+this.$el.querySelector("textarea").scrollHeight+"px"}},resizeTextareaElement:function(t){t.style.height="auto",t.style.height=t.scrollHeight+"px"},savePost:function(){this.busyLoading=!0;var t=this,e={};if(e.body=this.bodyText,e.privacy=this.privacyValue.value,this.editPost){var s=this.$config.get("api.apiPostUpdateUrl").replace("%node",this.editPost.nid).replace("%token",this.streamOptions.token);i.a.axios.post(s,e,{withCredentials:!0}).then(function(s){t.resetForm(),1===s.data.status&&(t.editPost.body=e.body,t.editPost.privacy.privacyDefault=e.privacy,t.resetForm())})}else{var a=this.$config.get("api.apiPostAddUrl").replace("%token",this.streamOptions.token);e.containerNID=this.streamOptions.containerNID,e.contextNID=this.streamOptions.contextNID,i.a.axios.post(a,e,{withCredentials:!0}).then(function(e){if(1===e.data.status){var s=e.data.nodeData;t.$emit("stream-post-added",s),t.$refs.vueDropZome.getQueuedFiles().length>0?(t.$refs.vueDropZome.setOption("url",t.getPostUploadUrl(s)),t.dropzoneResetAfterComplete=!0,t.$refs.vueDropZome.processQueue()):t.resetForm()}})}},resetForm:function(){if(this.editPost)this.$emit("form-edit-canceled"),this.$parent.$el.querySelector(".stream-post").style.height="auto";else{this.formActive=!1,this.bodyText="";var t=parseInt(this.privacyDefault);this.privacyValue=i.a._.filter(this.privacyOptions,["value",t])[0],this.$el.querySelector("textarea.stream-post-body").blur(),this.$el.querySelector("textarea.stream-post-body").style.height="auto"}this.$refs.vueDropZome.removeAllFiles(),this.busyLoading=!1},dragOver:function(t){var e=this;this.formActive=!0,this.$nextTick(function(){"250px"!==e.$refs.vueDropZome.$el.style.height&&(e.resizeDropArea(),e.$refs.vueDropZome.$el.querySelector("div.dz-message").style.marginTop="100px",e.resizePostFormContainer())})},uploadCompleted:function(){this.editPost||(this.resetForm(),this.dropzoneResetAfterComplete=!1)},resizeDropArea:function(){this.$refs.vueDropZome.$el.style.height="250px"},updateAuthor:function(){this.author=this.streamOptions.loggedInUser,this.editPost&&(this.author=this.editPost.user)},loadPrivacyOptions:function(t){var e=[];return Array.isArray(t)&&Array.isArray(this.streamOptions.privacyOptions)?(this.streamOptions.privacyOptions.forEach(function(s){t.indexOf(s.value)>-1&&e.push(s)}),e):e},initializePost:function(){var t=this;if(this.editPost){this.formActive=!0,this.bodyText=this.editPost.body,this.privacyDefault=this.editPost.privacy.privacyDefault,this.privacyOptions=this.loadPrivacyOptions(this.editPost.privacy.privacyOptions);var e=parseInt(this.privacyDefault);this.privacyValue=i.a._.filter(this.privacyOptions,["value",e])[0],this.$nextTick(function(){t.resizeTextareaElement(t.$el.querySelector("textarea")),t.$refs.vueDropZome.$el.style.height="50px",t.$refs.vueDropZome.$el.querySelector("div.dz-message").style.marginTop="10px",t.resizePostFormContainer()})}},getPostUploadUrl:function(t){return t||(t=this.editPost),t?this.$config.get("api.apiPostAttachmentUploadUrl").replace("%node",t.nid).replace("%token",this.streamOptions.token):this.$config.get("api.apiPostAttachmentUploadUrl").replace("%node",0).replace("%token",this.streamOptions.token)},getAutoProcessQueue:function(){return!!this.editPost},getDropZomeRemoveLabel:function(){return this.editPost?this.$t("label.nmDictHideFile"):this.$t("label.dictRemoveFile")},onAttachmentDeleteConf:function(t){this.$emit("post-form-onAttachmentDeleteConf",t)}},watch:{},mounted:function(){var t=this;if(this.privacyDefault=this.streamOptions.privacyDefault,this.privacyOptions=this.streamOptions.privacyOptions,this.loggedInUser=this.streamOptions.loggedInUser,this.$nextTick(function(){t.$el.setAttribute("style","height:"+t.$el.scrollHeight+"px;overflow-y:hidden;"),t.$el.addEventListener("input",t.resizeTextarea)}),!this.privacyValue){this.editPost?(this.privacyOptions=this.loadPrivacyOptions(this.editPost.privacy.privacyOptions),this.privacyDefault=this.editPost.privacy.privacyDefault):(this.privacyOptions=this.streamOptions.privacyOptions,this.privacyDefault=this.streamOptions.privacyDefault);var e=parseInt(this.privacyDefault);this.privacyValue=i.a._.filter(this.privacyOptions,["value",e])[0]}this.loggedInUser=this.streamOptions.loggedInUser,this.updateAuthor()},beforeDestroy:function(){this.$el.removeEventListener("input",this.resizeTextarea)},render:function(){return this.$slots.default[0]},data:function(){return{loggedInUser:null,author:null,privacyOptions:null,privacyDefault:null,formActive:!1,bodyText:"",privacyValue:null,dropzoneResetAfterComplete:!1,files:null,busyLoading:!1,busyLoadingColor:"#888",busyLoadingSize:"10px",dropzoneOptions:{url:this.getPostUploadUrl(),createImageThumbnails:!1,autoProcessQueue:this.getAutoProcessQueue(),addRemoveLinks:!0,maxFilesize:20,dictDefaultMessage:this.$t("label.dictDefaultMessage"),dictFallbackMessage:this.$t("label.dictFallbackMessage"),dictFileTooBig:this.$t("label.dictFileTooBig"),dictInvalidFileType:this.$t("label.dictInvalidFileType"),dictCancelUpload:this.$t("label.dictCancelUpload"),dictUploadCanceled:this.$t("label.dictUploadCanceled"),dictCancelUploadConfirmation:this.$t("label.dictCancelUploadConfirmation"),dictRemoveFile:this.getDropZomeRemoveLabel(),dictMaxFilesExceeded:this.$t("label.dictMaxFilesExceeded")}}}}),u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"stream-post-from card",on:{dragover:t.dragOver}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-2"},[s("transition",{attrs:{name:"fade"}},[t.formActive?s("img",{key:t.formActive,staticClass:"card-img-top rounded-circle",attrs:{src:t.author.avatarUrl,title:t.author.name}}):t._e()])],1),t._v(" "),s("div",{staticClass:"col-10"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.bodyText,expression:"bodyText"}],staticClass:"stream-post-body",attrs:{name:"body",disabled:t.busyLoading,placeholder:t.$t("placeholder.your_post_message")},domProps:{value:t.bodyText},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"esc",27,e.key,"Escape")?t.resetForm(e):null},focus:function(e){t.formActive=!0},input:function(e){e.target.composing||(t.bodyText=e.target.value)}}}),t._v(" "),s("div",{staticClass:"row stream-action-1"},[s("transition",{attrs:{name:"fade"}},[t.formActive?s("div",{key:t.formActive,staticClass:"col-12 stream-attachments"},[s("vue-dropzone",{ref:"vueDropZome",attrs:{id:"dropzone",options:t.dropzoneOptions,disabled:t.busyLoading},on:{"vdropzone-file-added":t.resizeDropArea,"vdropzone-complete":t.uploadCompleted}}),t._v(" "),t.editPost&&t.editPost.attachments.length>0?s("div",{ref:"postAttachmentList",staticClass:"stream-post-attachments"},[s("font-awesome-icon",{attrs:{icon:["far","file"]}}),t._v("\n              "+t._s(t.$t("label.attachments"))+"\n              "),t._l(t.editPost.attachments,function(e){return s("div",{key:e.fid},[s("span",{domProps:{innerHTML:t._s(e.download_link)}}),t._v(" "),e.permissions.canDelete?s("a",{staticClass:"attachment-trash-delete",attrs:{href:"#",title:t.$t("button.delete_attachment")},on:{click:function(s){s.preventDefault(),t.onAttachmentDeleteConf(e)}}},[s("font-awesome-icon",{attrs:{icon:["far","trash-alt"]}})],1):t._e()])})],2):t._e(),t._v(" "),s("pulse-loader",{attrs:{loading:t.busyLoading,color:t.busyLoadingColor,size:t.busyLoadingSize}})],1):t._e()])],1),t._v(" "),s("div",{staticClass:"row stream-action-2"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"row"},[s("transition",{attrs:{name:"fade"}},[t.formActive?s("div",{key:t.formActive,staticClass:"col-12 action-buttons"},[t.privacyOptions.length>0?s("div",{staticClass:"stream-post-privacy-settings"},[s("multiselect",{attrs:{options:t.privacyOptions,"track-by":"value","option-height":104,searchable:!1,"show-labels":!1,"allow-empty":!1,placeholder:t.$t("button.select_privacy"),disabled:t.busyLoading},scopedSlots:t._u([{key:"singleLabel",fn:function(e){return[s("img",{staticClass:"option__image",attrs:{src:e.option.img,alt:e.option.title}}),t._v(" "),s("span",{staticClass:"option__desc"},[s("span",{staticClass:"option__title"},[t._v(t._s(e.option.title))])])]}},{key:"option",fn:function(e){return[s("img",{staticClass:"option__image",attrs:{src:e.option.img,alt:e.option.title,disabled:t.busyLoading}}),t._v(" "),s("div",{staticClass:"option__desc"},[s("span",{staticClass:"option__title"},[t._v(t._s(e.option.title))]),s("span",{staticClass:"option__small"},[t._v(t._s(e.option.desc))])])]}}]),model:{value:t.privacyValue,callback:function(e){t.privacyValue=e},expression:"privacyValue"}})],1):t._e(),t._v(" "),s("button",{staticClass:"btn btn-outline-primary stream-post-post float-right",attrs:{disabled:this.bodyText.length<1||t.busyLoading},on:{click:t.savePost}},[t._v(t._s(t.$t("button.post")))]),t._v(" "),s("button",{staticClass:"btn btn-outline-secondary stream-post-cancel float-right",attrs:{disabled:t.busyLoading},on:{click:t.resetForm}},[t._v(t._s(t.$t("button.cancel")))])]):t._e()])],1)])])])])])},staticRenderFns:[]};var h=s("VU/8")(p,u,!1,function(t){s("uGGa"),s("fc1g")},"data-v-4b6fd64a",null).exports,v={props:["streamOptions","post","comments"],components:{StreamComment:c,StreamCommentForm:o,StreamPostForm:h},name:"stream-post",data:function(){return{showComments:!1,curDeleteAttachment:null}},computed:{canEdit:function(){return this.post.permissions.canEdit},canDelete:function(){return this.post.permissions.canDelete},canCreateComment:function(){return!0},sortedComments:function(){return i.a._.orderBy(this.comments,"created","desc")},modalID:function(){return"modal-delete"+this.post.nid},privacy:function(){var t=parseInt(this.post.privacy.privacyDefault);return i.a._.filter(this.streamOptions.privacyOptions,["value",t])[0]}},methods:{editPost:function(t){var e=this;this.showComments=!1,this.$el.classList.add("flip-active"),setTimeout(function(){e.$refs.streamPostForm.initializePost()},200),this.$refs.backDelete.classList.add("hide"),this.$refs.backEdit.classList.remove("hide")},deletePost:function(t){var e=this;this.showComments=!1,setTimeout(function(){e.$el.classList.add("flip-active"),e.$refs.backEdit.classList.add("hide"),e.$refs.backDelete.classList.remove("hide")},200)},editCanceled:function(t){this.$el.classList.remove("flip-active")},onDeleteSubmit:function(){var t=this,e=this,s=this.$config.get("api.apiPostDeleteUrl").replace("%node",this.post.nid).replace("%token",this.streamOptions.token);i.a.axios.get(s,{withCredentials:!0}).then(function(s){1===s.data.status&&(e.$emit("stream-post-deleted",e.post),t.$el.classList.remove("flip-active"))})},onDeleteCancel:function(){this.$el.classList.remove("flip-active")},onAttachmentDeleteConf:function(t){this.$refs.postDeleteAttachmentConf.show(),this.curDeleteAttachment=t},addUser:function(t){this.$emit("stream-user-added",t)},addComment:function(t){this.showComments=!0,this.$emit("stream-comment-added",t)},deleteComment:function(t){this.$emit("stream-comment-deleted",t)},hideModal:function(){this.$refs.postDeleteAttachmentConf.hide(),this.curDeleteAttachment=null},onAttachmentDelete:function(){var t=this.curDeleteAttachment,e=this,s=this.$config.get("api.apiPostAttachmentDeleteUrl").replace("%node",e.post.nid).replace("%file",t.fid).replace("%token",this.streamOptions.token);i.a.axios.get(s,{withCredentials:!0}).then(function(s){e.post.attachments.splice(e.post.attachments.indexOf(t),1)}),this.hideModal()}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card-flip"},[s("div",{staticClass:"flip"},[s("div",{staticClass:"front"},[s("div",{staticClass:"stream-post card"},[this.streamOptions.containerNID!==this.post.container.nid?s("div",{staticClass:"row post-context"},[s("div",{staticClass:"col-12"},[s("span",{staticClass:"float-right"},[t._v(" "+t._s(t.$t("label.postContextFrom"))+": "),s("a",{attrs:{href:this.post.container.link}},[t._v(t._s(this.post.container.title))])])])]):t._e(),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-2"},[s("img",{staticClass:"card-img-top rounded-circle",attrs:{src:t.post.user.avatarUrl,title:t.post.user.name}})]),t._v(" "),s("div",{staticClass:"col-10"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12 post-header"},[null!==this.privacy?s("div",{staticClass:"post-privacy-wrapper float-right"},[s("img",{staticClass:"post-privacy",attrs:{src:t.privacy.img,alt:t.privacy.title,title:t.privacy.title}})]):t._e(),t._v(" "),t.canEdit||t.canDelete?s("div",[s("b-dropdown",{staticClass:"post-actions-dropdown m-md-2 float-right",attrs:{text:"...",offset:"-120"}},[t.canEdit?s("b-dropdown-item",{on:{click:t.editPost}},[t._v(t._s(t.$t("button.edit")))]):t._e(),t._v(" "),t.canDelete?s("b-dropdown-item",{on:{click:t.deletePost}},[t._v(t._s(t.$t("button.delete")))]):t._e()],1)],1):t._e(),t._v(" "),s("div",{staticClass:"username"},[s("a",{attrs:{href:t.post.user.profileUrl}},[t._v(t._s(t.post.user.name))])]),t._v(" "),s("div",{staticClass:"created"},[s("font-awesome-icon",{attrs:{icon:["far","clock"]}}),s("span",{attrs:{title:t._f("moment")(t.post.created,"L LT")}},[t._v(" "+t._s(t._f("moment")(t.post.created,"from"))+"\n                    ")])],1)])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-12 body"},[s("p",{attrs:{tag:"p"},domProps:{innerHTML:t._s(t.post.body_formatted)}})])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[t.post.attachments.length>0?s("div",{staticClass:"stream-post-attachments"},[s("font-awesome-icon",{attrs:{icon:["far","file"]}}),t._v(" "+t._s(t.$t("label.attachments"))+"\n                  "),s("ul",t._l(t.post.attachments,function(e){return s("li",{key:e.fid},[s("span",{domProps:{innerHTML:t._s(e.download_link)}}),t._v(" "),e.permissions.canDelete?s("a",{staticClass:"attachment-trash-delete",attrs:{href:"#",title:t.$t("button.delete_attachment")},on:{click:function(s){s.preventDefault(),t.onAttachmentDeleteConf(e)}}},[s("font-awesome-icon",{attrs:{icon:["far","trash-alt"]}})],1):t._e()])}))],1):t._e(),t._v(" "),s("div",{staticClass:"stream-post-footer"},[t.sortedComments.length>0?s("div",[s("transition",{attrs:{name:"slide-fade"}},[t.showComments?s("a",{key:"false",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.showComments=!t.showComments}}},[t._v(t._s(t.$t("link.hide_x_comments",{count:t.sortedComments.length})))]):s("a",{key:"true",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.showComments=!t.showComments}}},[t._v("\n                        "+t._s(t.$t("link.show_x_comments",{count:t.sortedComments.length}))+"\n                      ")])])],1):t._e()])])])])]),t._v(" "),s("div",{staticClass:"row comments-wrapper"},[s("div",{staticClass:"col-10 offset-2"},[t.canCreateComment?s("stream-comment-form",{attrs:{streamOptions:t.streamOptions,post:t.post},on:{"stream-user-added":t.addUser,"stream-comment-added":t.addComment}}):t._e(),t._v(" "),s("transition",{attrs:{name:"fade"}},[t.sortedComments.length>0&&!0===t.showComments?s("div",[s("transition-group",{attrs:{name:"list"}},t._l(t.sortedComments,function(e){return s("stream-comment",{key:e.cid,attrs:{streamOptions:t.streamOptions,comment:e,user:e.user},on:{"stream-comment-deleted":t.deleteComment}})}))],1):t._e()])],1)])])]),t._v(" "),s("div",{ref:"backEdit",staticClass:"back-edit"},[s("div",{staticClass:"stream-post card"},[s("stream-post-form",{ref:"streamPostForm",attrs:{streamOptions:t.streamOptions,editPost:t.post},on:{"form-edit-canceled":function(e){t.editCanceled()},"post-form-onAttachmentDeleteConf":t.onAttachmentDeleteConf}})],1)]),t._v(" "),s("div",{ref:"backDelete",staticClass:"back-delete"},[s("div",{staticClass:"stream-post card"},[s("h3",[t._v(t._s(t.$t("warning.delete_post_really_want_to")))]),t._v(" "),s("br"),t._v(" "),s("p",[t._v("\n          "+t._s(t.$t("warning.delete_post_action_cannot_be_undone"))+"\n        ")]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"float-right"},[s("button",{staticClass:"btn btn-outline-danger float-right",on:{click:t.onDeleteSubmit}},[t._v(t._s(t.$t("button.delete")))]),t._v(" "),s("button",{staticClass:"btn btn-outline-secondary float-right",on:{click:t.onDeleteCancel}},[t._v(t._s(t.$t("button.cancel")))])])])])]),t._v(" "),s("b-modal",{ref:"postDeleteAttachmentConf",attrs:{"hide-footer":"",title:t.$t("label.attachment_delete")}},[s("div",{staticClass:"d-block text-center"},[t._v("\n      "+t._s(t.$t("warning.delete_attachment_really_want_to"))+"\n    ")]),t._v(" "),s("b-button",{staticClass:"mt-3",attrs:{variant:"",block:""},on:{click:t.hideModal}},[t._v(t._s(t.$t("button.cancel")))]),t._v(" "),s("b-button",{staticClass:"mt-3",attrs:{variant:"outline-danger",block:""},on:{click:function(e){t.onAttachmentDelete()}}},[t._v(t._s(t.$t("button.delete")))])],1)],1)},staticRenderFns:[]};var g=s("VU/8")(v,f,!1,function(t){s("pZ9W"),s("Avkv")},"data-v-5102ad8c",null).exports,y=s("Zrlr"),_=s.n(y),b=s("wxAW"),C=s.n(b),k=function(){function t(){_()(this,t),this.initUrl="https://dev1.div.onlinekurslabor.de/api/v2.0/nm_stream/node/15347/initialize",this.posts={},this.users={},this.comments={},this.streamOptions={},this.initializeContent()}return C()(t,[{key:"initializeContent",value:function(){}},{key:"getUpdate",value:function(){return{}}},{key:"addPost",value:function(){return{}}},{key:"updatePost",value:function(){return{}}},{key:"updateComment",value:function(){return{}}},{key:"fileDelete",value:function(){return{}}},{key:"getUser",value:function(t){return i.a._.find(this.users,["uid",t])}}]),t}(),D=function t(){_()(this,t),this.privacyDefault="",this.privacyOptions=[],this.loggedInUser="",this.containerNID="",this.contextNID="",this.token="",this.timestamp=""},$={name:"stream",components:{StreamPostForm:h,StreamPost:g,StreamComment:c},data:function(){return{posts:[],streamOptions:[],comments:[],users:[],busyLoadingMore:!1,busyLoadingColor:"#888",busyLoadingSize:"12px",maxPostsLimitReached:!1,loggedInUser:1,initialized:!1,infiniteScrollLimit:10,maxPostsToShow:10,pollingUpdate:null,containerNid:null,contentService:new k}},beforeMount:function(){this.$root.$el.attributes["data-container-nid"]&&(this.containerNid=this.$root.$el.attributes["data-container-nid"].value)},computed:{sortedPosts:function(){var t=i.a._.orderBy(this.posts,"created","desc");return t.slice(0,this.maxPostsToShow)}},methods:{initialize:function(){this.initializeStream()},addPost:function(t){this.posts.push(t)},deletePost:function(t){var e=this.posts.indexOf(t);this.posts.splice(e,1)},deleteComment:function(t){var e=this.comments.indexOf(t);this.comments.splice(e,1)},addComment:function(t){this.comments.push(t)},addUser:function(t){this.getUser(t.uid)||this.users.push(t)},initializeStream:function(){var t=this,e=this;i.a.axios.get(this.$config.get("api.apiInitUrl").replace("%node",this.containerNid),{withCredentials:!0}).then(function(s){e.posts=s.data.stream.posts,e.users=s.data.stream.users,e.comments=s.data.stream.comments,e.streamOptions=new D,e.streamOptions.privacyOptions=s.data.stream.privacyOptions,e.streamOptions.privacyDefault=s.data.stream.privacyDefault,e.streamOptions.loggedInUser=t.getUser(s.data.stream.loggedInUser),e.streamOptions.token=s.data.stream.token,e.streamOptions.contextNID=s.data.stream.contextNID,e.streamOptions.containerNID=s.data.stream.containerNID,e.streamOptions.timestamp=s.data.stream.timestamp,e.initialized=!0,e.pollUpdate()})},loadMore:function(){if(!this.initialized||this.busyLoadingMore||this.maxPostsLimitReached)return!1;this.busyLoadingMore=!0,this.maxPostsToShow+=this.infiniteScrollLimit,this.pollUpdate()},getUser:function(t){return i.a._.find(this.users,["uid",t])},getNodeComments:function(t){var e=i.a._.filter(this.comments,["nid",t]);if(e.length>0)for(var s in e)e[s].user=this.getUser(e[s].uid);return e},getLoadedPost:function(t){return t.user=this.getUser(t.uid),t},pollUpdate:function(){var t=this,e=this;clearInterval(this.pollingUpdate),this.pollingUpdate=setInterval(function(){if(document.hasFocus()){var s=t.$config.get("api.apiPollUpdateUrl").replace("%node",t.streamOptions.containerNID).replace("%offset",0).replace("%limit",e.maxPostsToShow).replace("%token",e.streamOptions.token);i.a.axios.get(s,{withCredentials:!0}).then(function(t){e.busyLoadingMore&&(e.maxPostsLimitReached=e.posts.length>=t.data.stream.posts.length,e.busyLoadingMore=!1),e.posts=t.data.stream.posts,e.users=t.data.stream.users,e.comments=t.data.stream.comments,e.streamOptions.timestamp=t.data.stream.timestamp})}},5e3)},mergeByProperty:function(t,e,s){i.a._.each(e,function(e){var a=i.a._.find(t,function(t){return t[s]===e[s]});a?i.a._.extend(a,e):t.push(e)})}},mounted:function(){this.initialize(),window.addEventListener("dragover",function(t){(t=t||event).preventDefault()},!1),window.addEventListener("drop",function(t){(t=t||event).preventDefault()},!1)},beforeDestroy:function(){clearInterval(this.pollingUpdate)}},j={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container",attrs:{id:"stream"}},[s("pulse-loader",{attrs:{loading:!t.initialized,color:t.busyLoadingColor,size:t.busyLoadingSize}}),t._v(" "),t.initialized&&t.streamOptions.containerNID>0?s("stream-post-form",{attrs:{streamOptions:t.streamOptions},on:{"stream-post-added":t.addPost}}):t._e(),t._v(" "),s("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"},{name:"keep-scroll-position",rawName:"v-keep-scroll-position"}],staticClass:"stream-post-wrapper",attrs:{"infinite-scroll-disabled":"busyLoading","infinite-scroll-distance":"10"}},[s("transition-group",{attrs:{name:"list"}},t._l(t.sortedPosts,function(e){return s("stream-post",{key:e.nid,attrs:{post:t.getLoadedPost(e),comments:t.getNodeComments(e.nid),streamOptions:t.streamOptions},on:{"stream-post-deleted":t.deletePost,"stream-comment-deleted":t.deleteComment,"stream-comment-added":t.addComment,"stream-user-added":t.addUser}})}))],1),t._v(" "),s("br"),t._v(" "),s("pulse-loader",{attrs:{loading:t.busyLoadingMore,color:t.busyLoadingColor,size:t.busyLoadingSize}}),t._v(" "),s("br")],1)},staticRenderFns:[]};var x=s("VU/8")($,j,!1,function(t){s("0dp7"),s("i63D")},"data-v-15f81264",null).exports,w=s("e6fC"),z=(s("tLvy"),s("NETs")),U=s.n(z),P=s("RUzx"),L=s("C/JF"),O=s("Yu89"),F=s("1e6/"),A=s("TXmL"),S=s("UqSQ"),T=s.n(S),E=s("mtWM"),I=s.n(E),M=s("Rf8U"),N=s.n(M),q=s("j93a"),R=s.n(q),H=s("gf/g"),V=s("bqTm"),B=s.n(V),Z=s("MVBf"),W=s.n(Z),X={name:"PulseLoader",props:{loading:{type:Boolean,default:!0},color:{type:String,default:"#5dc596"},size:{type:String,default:"15px"},margin:{type:String,default:"2px"},radius:{type:String,default:"100%"}},data:function(){return{spinnerStyle:{backgroundColor:this.color,width:this.size,height:this.size,margin:this.margin,borderRadius:this.radius,display:"inline-block",animationName:"v-pulseStretchDelay",animationDuration:"0.75s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.2,.68,.18,1.08)",animationFillMode:"both"},spinnerDelay1:{animationDelay:"0.12s"},spinnerDelay2:{animationDelay:"0.24s"},spinnerDelay3:{animationDelay:"0.36s"}}}},K={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{directives:[{name:"show",rawName:"v-show",value:this.loading,expression:"loading"}],staticClass:"v-spinner"},[e("div",{staticClass:"v-pulse v-pulse1",style:[this.spinnerStyle,this.spinnerDelay1]}),e("div",{staticClass:"v-pulse v-pulse2",style:[this.spinnerStyle,this.spinnerDelay2]}),e("div",{staticClass:"v-pulse v-pulse3",style:[this.spinnerStyle,this.spinnerDelay3]})])},staticRenderFns:[]};var Q=s("VU/8")(X,K,!1,function(t){s("0eAL")},null,null).exports;L.c.add(O.a,O.b,O.c),i.a.component("font-awesome-icon",F.a),i.a.component("pulse-loader",Q),i.a.component("multiselect",P.Multiselect),i.a.config.productionTip=!1,i.a.use(w.a),i.a.use(U.a),i.a.use(A.a),i.a.use(N.a,I.a),i.a.use(H.a,{config:{api:{apiInitUrl:"/api/v2.0/nm_stream/node/%node/initialize",apiPollUpdateUrl:"/api/v2.0/nm_stream/node/%node/poll_update/%offset/%limit/%token",apiPostAttachmentDeleteUrl:"/api/v2.0/nm_stream/node/%node/file/%file/delete/%token",apiPostAttachmentUploadUrl:"/api/v2.0/nm_stream/node/%node/file/upload/%token",apiPostUpdateUrl:"/api/v2.0/nm_stream/node/%node/update/%token",apiPostAddUrl:"/api/v2.0/nm_stream/node/add/%token",apiPostDeleteUrl:"/api/v2.0/nm_stream/node/%node/delete/%token",apiCommentUpdateUrl:"/api/v2.0/nm_stream/comment/%comment/update/%token",apiCommentAddUrl:"/api/v2.0/nm_stream/node/%node/comment/add/%token",apiCommentDeleteUrl:"/api/v2.0/nm_stream/comment/%comment/delete/%token"}}}),i.a.use(B.a),i.a.component("nl2br",R.a),i.a.use(W.a);var G=s("PJh5");s("DOkx"),i.a.use(s("8AgW"),{moment:G});var J=new A.a({locale:"de",messages:T.a});window.stream=new i.a({i18n:J,el:"#stream",components:{Stream:x},template:'<stream ref="stream"></stream>',mounted:function(){},methods:{loadJsonSample:function(t){}}})},Pjiz:function(t,e){},UqSQ:function(t,e){t.exports={de:{placeholder:{your_post_message:"Ihre Nachricht",your_comment_message:"Ihr Kommentar"},label:{attachments:"Anhänge",upload_files:"Dateien hochladen",attachment_delete:"Anhang löschen",dictDefaultMessage:"<i class='fa fa-cloud-upload'></i> Dateien hochladen",dictFallbackMessage:"Ihr Browser unterstützt leider keinen Upload",dictFileTooBig:"Die hochgeladene Datei ist zu groß. {{filesize}} / {{maxFilesize}}",dictInvalidFileType:"Dieser Dateityp wird nicht unterstützt",dictCancelUpload:"Upload abbrechen",dictUploadCanceled:"Der Upload wurde abgebrochen",dictCancelUploadConfirmation:"Upload wirklich abbrechen?",dictRemoveFile:"Entfernen",nmDictHideFile:"Verstecken",dictMaxFilesExceeded:"Das Uploadlimit von {{maxFiles}} wurde überschritten",postContextFrom:"Beitrag aus"},link:{show_x_comments:"{count} Kommentare anzeigen",hide_x_comments:"{count} Kommentare verstecken"},button:{cancel:"Abbrechen",post:"Teilen",edit:"Bearbeiten",delete:"Löschen",select_privacy:"Sichtbarkeit festlegen",delete_attachment:"Anhang löschen"},warning:{delete_post_really_want_to:"Möchten Sie den Beitrag wirklich löschen?",delete_attachment_really_want_to:"Möchten Sie den Anhang wirklich löschen?",delete_post_action_cannot_be_undone:"Sie sind dabei einen Beitrag zu löschen. Diese Aktion kann nicht rückgängig gemacht werden.",delete_comment_really_want_to:"Möchten Sie den Kommentar wirklich löschen?",delete_comment_action_cannot_be_undone:"Sie sind dabei einen Kommentar zu löschen. Diese Aktion kann nicht rückgängig gemacht werden."}}}},fc1g:function(t,e){},i63D:function(t,e){},pZ9W:function(t,e){},tLvy:function(t,e){},uGGa:function(t,e){},uslO:function(t,e,s){var i={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function a(t){return s(n(t))}function n(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}a.keys=function(){return Object.keys(i)},a.resolve=n,t.exports=a,a.id="uslO"},zLEU:function(t,e){},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.1099ef1ea99108a8723b.js.map